<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Properties | Alture & Co.</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Montserrat:wght@200;300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="css/properties.css">
    <style>
        /* Styles spécifiques qui doivent rester en ligne */
        .logo span {
            color: #D14D72;
        }
        
        .properties-grid {
        }
        
        /* Styles spécifiques qui doivent rester en ligne */
        .feature div {
            color: #666;
            font-size: 0.9rem;
            font-family: 'Montserrat', sans-serif;
        }
        
        .pink-amp {
            color: #D14D72;
            font-weight: 400;
        }
        
        @media (max-width: 768px) {
            .properties-hero {
                padding: 150px 20px 80px;
            }
            
            .properties-grid {
                grid-template-columns: 1fr;
            }
            
            .property-features {
                flex-wrap: wrap;
                gap: 15px;
            }
            
            .feature {
                flex: 0 0 calc(50% - 10px);
            }
        }
        </style>
</head>
<body>
    <!-- Préchargeur -->
    <div class="preloader">
        <div class="preloader-inner">
            <div class="loading-text">
                <span class="char">L</span>
                <span class="char">O</span>
                <span class="char">A</span>
                <span class="char">D</span>
                <span class="char">I</span>
                <span class="char">N</span>
                <span class="char">G</span>
            </div>
        </div>
    </div>
    
    <!-- Barre de progression -->
    <div class="progress-container">
        <div class="progress-bar" id="myBar"></div>
    </div>
    <!-- Préchargeur -->
    <div class="preloader">
        <div class="preloader-inner">
            <div class="loading-text">
                <span class="char">L</span>
                <span class="char">O</span>
                <span class="char">A</span>
                <span class="char">D</span>
                <span class="char">I</span>
                <span class="char">N</span>
                <span class="char">G</span>
            </div>
        </div>
    </div>
    
    <!-- Barre de progression -->
    <div class="progress-container">
        <div class="progress-bar" id="myBar"></div>
    </div>
    <header>
        <div class="header-container">
            <div class="logo">

                <a href="index.html" id="simple-logo">
                    <span id="simple-logo-short">A<span class="pink-amp">&</span>C</span>
                    <span id="simple-logo-full">Alture <span class="pink-amp">&</span> Co.</span>
                </a>
            </div>
            <button class="menu-toggle" aria-label="Menu">
                <span class="menu-line"></span>
                <span class="menu-line"></span>
                <span class="menu-line"></span>
            </button>
            <nav>
                <a href="index.html">Home</a>
                <a href="#" style="color: #D14D72;">Properties</a>
                <a href="index.html#contact">Contact</a>
            </nav>
        </div>
    </header>
    
    <section class="properties-hero">
        <div class="hero-content">
            <h1>Our Exclusive Properties</h1>
            <p>Discover our handpicked selection of luxury properties around the world</p>
            <a href="#properties" class="btn">View Properties</a>
        </div>
    </section>
    
    <!-- Galerie Modale -->
    <div id="galleryModal" class="modal">
        <!-- Bouton de fermeture -->
        <button class="close-modal" aria-label="Close" onclick="closeModal()">
            <i class="fas fa-times"></i>
        </button>
        
        <div class="modal-content">
            <!-- Conteneur principal de la galerie -->
            <div class="gallery-container">
                <!-- Conteneur pour le média (image ou vidéo) -->
                <div class="media-viewer-container">
                    <div class="media-viewer-wrapper" id="mainMedia">
                        <!-- Le contenu sera ajouté dynamiquement par JavaScript -->
                    </div>
                    
                    <!-- Flèches de navigation -->
                    <button class="nav-arrow prev" aria-label="Image précédente" onclick="prevImage()">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="nav-arrow next" aria-label="Image suivante" onclick="nextImage()">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <!-- Informations de la propriété -->
                <div class="property-info">
                    <h2 id="propertyTitle"></h2>
                    <p class="property-price"><span class="currency">AED</span> <span id="propertyPrice"></span></p>
                    <p class="property-location" id="propertyLocation"></p>
                    <p class="property-description" id="propertyDescription"></p>
                    
                    <div class="property-features" id="propertyFeatures">
                        <!-- Les caractéristiques seront ajoutées dynamiquement -->
                    </div>
                    
                    <a href="#contact" class="btn btn-primary">
                        Contact Us <i class="fas fa-arrow-right"></i>
                    </a>
                </div>
                
                <!-- Miniatures -->
                <div class="gallery-thumbnails" id="galleryThumbnails">
                    <!-- Les miniatures seront ajoutées dynamiquement -->
                </div>
            </div>
        </div>
    </div>

    <div id="properties" class="properties-container">
        <h2>Featured Properties</h2>
        <div class="properties-grid">
            <!-- Five Palm Jumeirah Property -->
            <div class="property-card">
                <div class="property-image-container">
                    <img src="images/Five palm Jumeirah 3BED/image0.jpeg" alt="Five Palm Jumeirah" class="property-image">
                    <button class="view-gallery-btn" data-property="five-palm-jumeirah">View Gallery</button>
                </div>
                <div class="property-details">
                    <h3 class="property-title">Five Palm Jumeirah</h3>
                    <p class="property-location"><i class="fas fa-map-marker-alt"></i> Dubai, Palm Jumeirah</p>
                    <p class="property-price">AED 10,000,000.00</p>
                    <p class="property-description">Exclusive 3-bedroom residence with stunning sea views, luxury finishes, and access to world-class amenities in one of Dubai's most prestigious locations.</p>
                    <div class="property-features">
                        <div class="feature">
                            <i class="fas fa-bed"></i>
                            <div>3 Beds</div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-bath"></i>
                            <div>3.5 Baths</div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-ruler-combined"></i>
                            <div>2,770 Sq Ft</div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-swimming-pool"></i>
                            <div>Pool View</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Jumeirah Islands Property -->
            <div class="property-card">
                <div class="property-image-container">
                    <img src="images/Jumeirah Islands/Main.jpg" alt="Jumeirah Islands Entertainment Foyer Villa" class="property-image">
                    <button class="view-gallery-btn" data-property="jumeirah-islands">View Gallery</button>
                </div>
                <div class="property-details">
                    <h3 class="property-title">Jumeirah Islands</h3>
                    <p class="property-location"><i class="fas fa-map-marker-alt"></i> Dubai, Jumeirah Islands</p>
                    <p class="property-price">Price on Request</p>
                    <p class="property-description">Entertainment Foyer Villa with stunning lake views, private pool, and luxurious finishes in the prestigious Jumeirah Islands community.</p>
                    <div class="property-features">
                        <div class="feature">
                            <i class="fas fa-bed"></i>
                            <div>4 Beds</div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-home"></i>
                            <div>5,231 Sq Ft</div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-vector-square"></i>
                            <div>8,796 Sq Ft Plot</div>
                        </div>
                        <div class="feature">
                            <i class="fas fa-umbrella-beach"></i>
                            <div>Lake View</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer class="site-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <div class="footer-logo">
                        <a href="index.html">Alture & Co.</a>
                    </div>
                    <p>Luxury real estate in Dubai's most exclusive locations.</p>
                    <div class="social-links">
                        <a href="https://wa.me/971509845622" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                        <a href="https://www.instagram.com/altureco" aria-label="Instagram" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-heading">Contact</h3>
                    <ul class="footer-contact">
                        <li>
                            <i class="fab fa-whatsapp"></i>
                            <a href="https://wa.me/971509845622">+971 50 984 5622</a>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:info@altureco.com">info@altureco.com</a>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2023 Alture & Co. All rights reserved. | <a href="privacy-policy.html">Privacy Policy</a></p>
            </div>
        </div>
    </footer>
    
    <script>
        // Données de la propriété Five Palm Jumeirah
        const propertyData = {
            'five-palm-jumeirah': {
                title: 'Five Palm Jumeirah',
                price: 'AED 10,000,000.00',
                description: '3 Bedroom, 10th Floor | Five Palm Jumeirah\n\n3 Bedrooms + Maid\'s Room, 2,770 Sq Ft\n\nFully Furnished\n\nCorner Unit with Sea & Palm View\n\n2 Parking Spaces\n\n2 Large Balconies, including 1 with Jacuzzi\n\nArea: 2,770 Sq Ft\n\nVacant on Transfer',
                media: [
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image0.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image1.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image2.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image3.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image4.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image5.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image6.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image7.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image8.jpeg' },
                    { type: 'image', url: 'images/Five palm Jumeirah 3BED/image10.jpeg' },
                    { 
                        type: 'video', 
                        url: 'vidéo/Five palm jumeirah.mp4',
                        thumbnail: 'images/Five palm Jumeirah 3BED/image0.jpeg' // Utilisation de la première image comme miniature
                    }
                ]
            },
            'jumeirah-islands': {
                title: 'Jumeirah Islands',
                price: 'Price on Request',
                description: 'Entertainment Foyer Villa | Jumeirah Islands\n\n4 Bedrooms + Maid\'s Room\nBUA: 5,231 sqft\nPlot Size: 8,796 sqft\nBrand New Villa\nFull Lake View\nFully Equipped Kitchen\nPrivate Pool\nBBQ Area\nVacant',
                media: [
                    { type: 'image', url: 'images/Jumeirah Islands/Main.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img7.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img11.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img15.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img19.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img23.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img27.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img31.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img35.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img39.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img43.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img47.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img51.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img55.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img59.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img63.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img67.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img71.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img75.jpg' },
                    { type: 'image', url: 'images/Jumeirah Islands/img79.jpg' },
                    { 
                        type: 'video', 
                        url: 'images/Jumeirah Islands/video palm.mp4',
                        thumbnail: 'images/Jumeirah Islands/Main.jpg'
                    }
                ]
            }
        };

        // Variables globales pour la navigation dans la galerie
        let currentProperty = null;
        let currentImageIndex = 0;
        let propertyImages = [];
        let isModalOpen = false;
        let modalCloseTimeout = null;
        let touchStartX = 0; // Pour la détection du glissement sur mobile

        // Fonction pour afficher un média (image ou vidéo) spécifique
        window.showMedia = function(index) {
            if (!currentProperty || !currentProperty.media || currentProperty.media.length === 0) return;
            
            // Mettre à jour l'index courant
            if (index < 0) index = currentProperty.media.length - 1;
            if (index >= currentProperty.media.length) index = 0;
            
            currentImageIndex = index;
            const media = currentProperty.media[index];
            const mainMedia = document.getElementById('mainMedia');
            
            if (!mainMedia) return;
            
            // Mettre en pause la vidéo en cours si elle existe
            const currentVideo = mainMedia.querySelector('video');
            if (currentVideo) {
                currentVideo.pause();
            }
            
            // Effacer le contenu précédent
            mainMedia.innerHTML = '';
            
            // Créer un conteneur pour le média
            const mediaContainer = document.createElement('div');
            mediaContainer.className = 'media-viewer-container';
            
            // Ajouter une classe de chargement
            mainMedia.classList.add('loading');
            
            if (media.type === 'image' || !media.type) {
                // Gestion des images (rétrocompatibilité avec l'ancien format)
                const img = document.createElement('img');
                img.className = 'media-viewer';
                img.alt = `Image ${index + 1} - ${currentProperty?.title || 'Property'}`;
                
                img.onload = function() {
                    mainMedia.classList.remove('loading');
                    mainMedia.classList.add('loaded');
                    updateActiveThumbnail(index);
                };
                
                img.onerror = function() {
                    mainMedia.innerHTML = '<div class="media-error">Erreur de chargement de l\'image</div>';
                    mainMedia.classList.remove('loading');
                };
                
                img.src = media.url || media; // Support pour l'ancien format (chaîne simple)
                mediaContainer.appendChild(img);
                
            } else if (media.type === 'video') {
                // Création du conteneur vidéo
                const videoContainer = document.createElement('div');
                videoContainer.className = 'video-container';
                
                const video = document.createElement('video');
                video.className = 'media-viewer video';
                video.src = media.url;
                video.controls = true;
                video.playsInline = true;
                video.preload = 'metadata';
                video.setAttribute('aria-label', `Vidéo de la propriété ${currentProperty?.title || ''}`);
                
                // Gestion du chargement de la vidéo
                video.onloadeddata = function() {
                    mainMedia.classList.remove('loading');
                    mainMedia.classList.add('loaded');
                    updateActiveThumbnail(index);
                };
                
                video.onerror = function() {
                    mainMedia.innerHTML = '<div class="media-error">Erreur de chargement de la vidéo</div>';
                    mainMedia.classList.remove('loading');
                };
                
                videoContainer.appendChild(video);
                mediaContainer.appendChild(videoContainer);
                
                // Essayer de lire la vidéo automatiquement (peut être bloqué par le navigateur)
                const playPromise = video.play();
                if (playPromise !== undefined) {
                    playPromise.catch(error => {
                        console.log('La lecture automatique a été bloquée:', error);
                    });
                }
            }
            
            // Ajouter le conteneur de média au DOM
            mainMedia.appendChild(mediaContainer);
            
            // Mettre à jour la miniature active
            updateActiveThumbnail(index);
        }
        
        // Fonction pour afficher une image spécifique (rétrocompatibilité)
        window.showImage = function(index) {
            // Si la propriété utilise l'ancien format (tableau d'URLs)
            if (currentProperty && Array.isArray(currentProperty.images)) {
                propertyImages = currentProperty.images;
                if (index >= 0 && index < propertyImages.length) {
                    const mainMedia = document.getElementById('mainMedia');
                    if (mainMedia) {
                        mainMedia.innerHTML = '';
                        const img = new Image();
                        img.onload = function() {
                            mainMedia.appendChild(img);
                            updateActiveThumbnail(index);
                        };
                        img.src = propertyImages[index];
                        img.alt = `Image ${index + 1} - ${currentProperty?.title || 'Property'}`;
                    }
                }
            } else {
                // Utiliser la nouvelle fonction showMedia pour le nouveau format
                showMedia(index);
            }
        }

        // Fonction pour mettre à jour la miniature active
        window.updateActiveThumbnail = function(index) {
            const thumbnails = document.querySelectorAll('.thumbnail');
            const thumbnailsContainer = document.getElementById('galleryThumbnails');
            
            if (!thumbnailsContainer) return;
            
            thumbnails.forEach((thumb, i) => {
                if (i === index) {
                    thumb.classList.add('active');
                    
                    // Si c'est une vidéo, gérer la lecture
                    if (currentProperty && currentProperty.media && currentProperty.media[index]) {
                        const media = currentProperty.media[index];
                        if (media.type === 'video') {
                            // Mettre en pause la vidéo précédente si elle existe
                            const prevVideo = document.querySelector('#mainMedia video');
                            if (prevVideo) {
                                prevVideo.pause();
                            }
                            
                            // Si on clique sur la miniature d'une vidéo, on la lit
                            setTimeout(() => {
                                const newVideo = document.querySelector('#mainMedia video');
                                if (newVideo && newVideo.paused) {
                                    const playPromise = newVideo.play();
                                    if (playPromise !== undefined) {
                                        playPromise.catch(error => {
                                            console.log('La lecture automatique a été bloquée:', error);
                                        });
                                    }
                                }
                            }, 100);
                        }
                    }
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        // Fonction pour afficher le média suivant
        window.nextImage = function() {
            if (!currentProperty) return;
            const mediaItems = currentProperty.media || [];
            if (mediaItems.length === 0 && currentProperty.images) {
                // Rétrocompatibilité avec l'ancien format
                const nextIndex = (currentImageIndex + 1) % currentProperty.images.length;
                showImage(nextIndex);
            } else if (mediaItems.length > 0) {
                const nextIndex = (currentImageIndex + 1) % mediaItems.length;
                showMedia(nextIndex);
            }
        }
        
        // Fonction pour afficher le média précédent
        window.prevImage = function() {
            if (!currentProperty) return;
            const mediaItems = currentProperty.media || [];
            if (mediaItems.length === 0 && currentProperty.images) {
                // Rétrocompatibilité avec l'ancien format
                const prevIndex = (currentImageIndex - 1 + currentProperty.images.length) % currentProperty.images.length;
                showImage(prevIndex);
            } else if (mediaItems.length > 0) {
                const prevIndex = (currentImageIndex - 1 + mediaItems.length) % mediaItems.length;
                showMedia(prevIndex);
            }
        }

        // Gestionnaire d'événements pour les touches du clavier
        function handleKeyDown(e) {
            if (!isModalOpen) return;
            
            switch(e.key) {
                case 'Escape':
                    e.preventDefault();
                    closeModal();
                    break;
                case 'ArrowLeft':
                    e.preventDefault();
                    prevImage();
                    break;
                case 'ArrowRight':
                    e.preventDefault();
                    nextImage();
                    break;
            }
        }
        
        // Gestionnaires pour le glissement tactile sur mobile
        function handleTouchStart(e) {
            if (!isModalOpen) return;
            touchStartX = e.touches[0].clientX;
        }
        
        function handleTouchEnd(e) {
            if (!isModalOpen) return;
            
            const touchEndX = e.changedTouches[0].clientX;
            const diffX = touchStartX - touchEndX;
            
            // Seuil de glissement pour déclencher le changement d'image (50px par défaut)
            const swipeThreshold = 50;
            
            if (Math.abs(diffX) > swipeThreshold) {
                if (diffX > 0) {
                    nextImage(); // Glissement vers la gauche -> image suivante
                } else {
                    prevImage(); // Glissement vers la droite -> image précédente
                }
            }
        }

        // Fonction pour fermer la modale
        window.closeModal = function() {
            if (!isModalOpen) return;
            
            const modal = document.getElementById('galleryModal');
            if (!modal) return;
            
            // Arrêter toutes les vidéos en cours de lecture
            const videos = document.querySelectorAll('video');
            videos.forEach(video => {
                video.pause();
            });
            
            // Appeler la fonction de nettoyage si elle existe
            if (typeof modal._cleanUpListeners === 'function') {
                modal._cleanUpListeners();
                delete modal._cleanUpListeners;
            }
            
            // Démarrer l'animation de sortie
            modal.classList.remove('show');
            
            // Attendre la fin de l'animation avant de masquer la modale
            setTimeout(() => {
                modal.style.display = 'none';
                isModalOpen = false;
                
                // Réactiver le défilement du body
                document.body.style.overflow = '';
                document.body.style.paddingRight = '';
                
                // Réinitialiser l'index de l'image courante
                currentImageIndex = 0;
                
                // Nettoyer les références
                currentProperty = null;
                propertyImages = [];
            }, 300); // Durée de l'animation CSS (0.3s)
        }

        // Fonction globale pour ouvrir la galerie
        window.openGallery = function(propertyId) {
            console.log('Ouverture de la galerie pour la propriété:', propertyId);
            
            // Récupérer l'élément modal
            const modal = document.getElementById('galleryModal');
            if (!modal) {
                console.error('Élément modal non trouvé');
                return;
            }
            
            // Récupérer la propriété correspondante
            const property = propertyData[propertyId];
            if (!property) {
                console.error('Propriété non trouvée:', propertyId);
                return;
            }
            
            // Si la propriété utilise l'ancien format (tableau d'URLs), le convertir en nouveau format
            if (Array.isArray(property.images) && !property.media) {
                property.media = property.images.map(url => ({
                    type: 'image',
                    url: url
                }));
            }
            
            // Nettoyer les écouteurs d'événements précédents
            if (isModalOpen) {
                closeModal();
                // Attendre que la modale soit complètement fermée avant de la rouvrir
                setTimeout(() => openGallery(propertyId), 350);
                return;
            }
            
            // Stocker les informations de la propriété actuelle
            currentProperty = property;
            propertyImages = property.images || [];
            currentImageIndex = 0;
            
            console.log('Property data:', property);
            
            const mainImage = document.getElementById('mainImage');
            const thumbnailsContainer = document.getElementById('galleryThumbnails');
            const propertyTitle = document.getElementById('propertyTitle');
            const propertyPrice = document.getElementById('propertyPrice');
            const propertyLocation = document.getElementById('propertyLocation');
            const propertyDescription = document.getElementById('propertyDescription');
            const propertyFeatures = document.getElementById('propertyFeatures');

            // Mettre à jour les informations de la propriété
            if (propertyTitle) propertyTitle.textContent = property.title;
            if (propertyPrice) {
                propertyPrice.textContent = property.price ? 
                    property.price.toLocaleString() + ' €' : 'Prix sur demande';
            }
            
            if (propertyLocation) {
                propertyLocation.innerHTML = property.location ? 
                    `<i class="fas fa-map-marker-alt"></i> ${property.location}` : '';
            }
            
            if (propertyDescription) {
                propertyDescription.textContent = property.description || '';
            }
            
            // Mettre à jour les caractéristiques
            if (propertyFeatures) {
                propertyFeatures.innerHTML = '';
                
                // Ajouter les caractéristiques dynamiquement depuis l'objet property
                const features = [
                    { icon: 'bed', text: property.beds || 'N/A', tooltip: 'Chambres' },
                    { icon: 'bath', text: property.baths || 'N/A', tooltip: 'Salles de bain' },
                    { icon: 'ruler-combined', text: property.area ? `${property.area} m²` : 'N/A', tooltip: 'Surface' },
                    { icon: 'building', text: property.type || 'N/A', tooltip: 'Type de bien' }
                ];
                
                features.forEach(feature => {
                    if (feature.text && feature.text !== 'N/A') {
                        const featureEl = document.createElement('div');
                        featureEl.className = 'feature-item';
                        featureEl.innerHTML = `
                            <i class="fas fa-${feature.icon}"></i>
                            <span>${feature.text}</span>
                            <span class="tooltip">${feature.tooltip}</span>
                        `;
                        propertyFeatures.appendChild(featureEl);
                    }
                });
            }

            // Vider les miniatures précédentes
            if (thumbnailsContainer) {
                console.log('Conteneur des miniatures trouvé:', thumbnailsContainer);
                thumbnailsContainer.innerHTML = '';
                
                // Utiliser property.media ou property.images selon ce qui est disponible
                const mediaItems = property.media || [];
                console.log('Médias à afficher:', mediaItems);

                // Si aucun média n'est défini, utiliser les anciennes images pour la rétrocompatibilité
                if (mediaItems.length === 0 && property.images) {
                    mediaItems.push(...property.images.map(url => ({
                        type: 'image',
                        url: url
                    })));
                }

                // Ajouter les miniatures pour chaque média (image ou vidéo)
                mediaItems.forEach((media, index) => {
                    const thumbnail = document.createElement('div');
                    thumbnail.className = 'thumbnail' + (index === 0 ? ' active' : '');
                    
                    if (media.type === 'video') {
                        // Pour les vidéos, utiliser la miniature spécifiée ou une vignette par défaut
                        const thumbSrc = media.thumbnail || 'images/video-thumbnail.jpg';
                        thumbnail.innerHTML = `
                            <div class="video-thumbnail">
                                <img src="${thumbSrc}" alt="Vidéo ${index + 1}" loading="lazy">
                                <div class="play-icon"><i class="fas fa-play"></i></div>
                            </div>`;
                    } else {
                        // Pour les images, utiliser directement l'URL
                        const imgSrc = media.url || media; // Support pour l'ancien format
                        thumbnail.innerHTML = `<img src="${imgSrc}" alt="Image ${index + 1}" loading="lazy">`;
                    }
                    
                    thumbnail.addEventListener('click', (e) => {
                        e.preventDefault();
                        showMedia(index);
                    });

                    thumbnailsContainer.appendChild(thumbnail);
                });
                
                console.log('Nombre de miniatures ajoutées:', thumbnailsContainer.children.length);
            }

            // Afficher la modale avec animation
            if (modal) {
                // Empêcher le défilement du body
                document.body.style.overflow = 'hidden';
                document.body.style.paddingRight = window.innerWidth - document.documentElement.clientWidth + 'px';
                
                // Afficher la modale
                modal.style.display = 'block';
                
                // Forcer le reflow pour activer la transition
                void modal.offsetWidth;
                
                // Démarrer l'animation d'entrée
                modal.classList.add('show');
                
                // Mettre à jour l'état
                isModalOpen = true;
                
                // Afficher le premier média
                if (property.media && property.media.length > 0) {
                    showMedia(0);
                } else if (property.images && property.images.length > 0) {
                    // Rétrocompatibilité avec l'ancien format
                    showImage(0);
                }
                
                // Ajouter les écouteurs d'événements
                document.addEventListener('keydown', handleKeyDown);
                document.addEventListener('touchstart', handleTouchStart, { passive: true });
                document.addEventListener('touchend', handleTouchEnd, { passive: true });
                
                // Mettre le focus sur la modale pour la navigation au clavier
                modal.setAttribute('tabindex', '-1');
                modal.focus();
                
                // Gestion du clic en dehors de la modale
                const handleModalClick = function(e) {
                    if (e.target === modal) {
                        closeModal();
                    }
                };
                
                modal.addEventListener('click', handleModalClick);
                
                // Empêcher la propagation du clic sur le contenu
                const modalContent = modal.querySelector('.modal-content');
                if (modalContent) {
                    modalContent.addEventListener('click', function(e) {
                        e.stopPropagation();
                    });
                }
                
                // Nettoyage des écouteurs lors de la fermeture
                const cleanUp = function() {
                    modal.removeEventListener('click', handleModalClick);
                    document.removeEventListener('keydown', handleKeyDown);
                    document.removeEventListener('touchstart', handleTouchStart);
                    document.removeEventListener('touchend', handleTouchEnd);
                };
                
                // Stocker la fonction de nettoyage pour une utilisation ultérieure
                modal._cleanUpListeners = cleanUp;
            }
        }

        // Script pour le préchargeur et initialisation des composants
        document.addEventListener('DOMContentLoaded', function() {
            // Initialiser les boutons de galerie
            document.querySelectorAll('.view-gallery-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const propertyId = this.getAttribute('data-property');
                    console.log('Bouton cliqué, propriété:', propertyId);
                    openGallery(propertyId);
                });
            });
            
            console.log('Boutons de galerie initialisés');
            const preloader = document.querySelector('.preloader');
            if (preloader) {
                preloader.style.opacity = '0';
                preloader.style.visibility = 'hidden';
                
                // Supprimer le préchargeur après l'animation
                setTimeout(() => {
                    preloader.style.display = 'none';
                }, 500);
            }
            
            // Animation de la barre de défilement
            window.onscroll = function() {
                const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
                const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrolled = (winScroll / height) * 100;
                const scrollProgress = document.querySelector('.scroll-progress');
                if (scrollProgress) {
                    scrollProgress.style.width = scrolled + '%';
                }
            };
            
            // Menu mobile
            const menuToggle = document.querySelector('.menu-toggle');
            const nav = document.querySelector('nav');
            
            // Vérifier si les éléments existent
            if (menuToggle && nav) {
                // Initialiser le menu pour les mobiles
                function initMobileMenu() {
                    if (window.innerWidth <= 992) { // Breakpoint pour le menu mobile
                        nav.style.display = 'none';
                        menuToggle.style.display = 'flex';
                    } else {
                        nav.style.display = '';
                        menuToggle.style.display = 'none';
                    }
                }
                
                // Initialiser au chargement
                initMobileMenu();
                
                // Gérer le clic sur le bouton du menu
                menuToggle.addEventListener('click', function() {
                    nav.style.display = nav.style.display === 'none' || nav.style.display === '' ? 'block' : 'none';
                    menuToggle.classList.toggle('active');
                    
                    // Animation des lignes du bouton
                    const lines = menuToggle.querySelectorAll('.menu-line');
                    if (nav.style.display === 'block') {
                        lines[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
                        lines[1].style.opacity = '0';
                        lines[2].style.transform = 'rotate(-45deg) translate(5px, -5px)';
                        document.body.style.overflow = 'hidden';
                    } else {
                        lines[0].style.transform = '';
                        lines[1].style.opacity = '';
                        lines[2].style.transform = '';
                        document.body.style.overflow = '';
                    }
                });
                
                // Gérer le redimensionnement de la fenêtre
                window.addEventListener('resize', initMobileMenu);
            }
        });
    </script>
    <script>
        // Script pour le défilement fluide
        document.addEventListener('DOMContentLoaded', function() {
            // Désactiver le comportement par défaut des liens avec #
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    // Ne pas empêcher le comportement des liens vers des pages externes
                    if (this.getAttribute('href').startsWith('#') && 
                        this.getAttribute('href') !== '#') {
                        e.preventDefault();
                        
                        const targetId = this.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 80, // Ajuster pour le header fixe
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            });
            
            // Ajouter une classe au header lors du défilement
            const header = document.querySelector('header');
            if (header) {
                window.addEventListener('scroll', function() {
                    if (window.scrollY > 50) {
                        header.style.padding = '10px 0';
                        header.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.1)';
                    } else {
                        header.style.padding = '20px 0';
                        header.style.boxShadow = '0 2px 10px rgba(0, 0, 0, 0.1)';
                    }
                });
            }
            
            // Ajouter une animation de fondu pour les sections
            const fadeElements = document.querySelectorAll('.property-card');
            const fadeOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const fadeOnScroll = new IntersectionObserver(function(entries, fadeOnScroll) {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) {
                        return;
                    } else {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                        fadeOnScroll.unobserve(entry.target);
                    }
                });
            }, fadeOptions);
            
            fadeElements.forEach(element => {
                element.style.opacity = '0';
                element.style.transform = 'translateY(20px)';
                element.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
                fadeOnScroll.observe(element);
            });
        });
    </script>
    <script>
        // Menu Burger
        document.addEventListener('DOMContentLoaded', function() {
            const menuToggle = document.querySelector('.menu-toggle');
            const nav = document.querySelector('header nav');
            
            menuToggle.addEventListener('click', function() {
                nav.classList.toggle('active');
                document.body.style.overflow = nav.classList.contains('active') ? 'hidden' : '';
            });
            
            // Fermer le menu quand on clique sur un lien
            document.querySelectorAll('header nav a').forEach(link => {
                link.addEventListener('click', () => {
                    nav.classList.remove('active');
                    document.body.style.overflow = '';
                });
            });
            
            // Fermer le menu quand on clique en dehors
            document.addEventListener('click', function(e) {
                if (!nav.contains(e.target) && !menuToggle.contains(e.target)) {
                    nav.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });
        });
    </script>
</body>
</html>
